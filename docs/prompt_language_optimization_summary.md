# PPT大纲生成提示词语言优化总结

## 优化概述

本次优化针对 `src/summeryanyfile/config/prompts.py` 文件中的所有提示词模板进行了全面的语言表达优化，重点关注**生成内容的书面化和专业化**，同时允许对源材料内容进行**合理的层次化重组**，在保持严格基于源材料要求的前提下，显著提升生成大纲内容的专业性、准确性和表达质量。

## 核心优化原则

### 1. 保持核心约束不变
- **源材料依赖原则**：严格基于源材料、禁止内容编造、内容忠实性验证等核心要求完全保留
- **约束强度不减**：所有安全约束和质量控制机制得到加强而非削弱

### 2. 生成内容语言表达优化
- **书面化标准**：确保生成的大纲内容使用正式、规范的书面语言
- **专业化程度**：采用学术或商务场合的专业表述方式和标准术语
- **表达精炼**：在保持原意的前提下，使表达更加简洁、专业和有力
- **风格一致性**：保持整个大纲在专业化语言风格上的一致性

### 3. 结构组织灵活性增强
- **层次化重组**：允许对源材料内容进行合理的层次化重新组织
- **逻辑优化**：可调整内容顺序和结构，使其更符合PPT演示逻辑
- **结构适配**：使重组后的结构更适合PPT展示，提升演示效果
- **内容完整**：确保重组过程中不遗漏源材料的重要信息

### 4. 项目信息整合增强
- **项目信息参数化**：在所有提示词中加入项目基本信息、目标受众信息和风格要求参数
- **上下文感知**：确保生成的大纲充分考虑项目主题、应用场景、具体要求等上下文信息
- **受众定制化**：根据目标受众类型和自定义受众描述调整内容深度和表达方式
- **风格适配性**：根据PPT风格要求和自定义风格提示调整内容组织和表达风格

### 5. 操作性增强
- **指令具体化**：使每个步骤的要求更加具体和可执行
- **验证标准明确化**：提供更清晰的验证标准和检查清单
- **执行流程优化**：优化任务执行的逻辑流程

## 具体优化内容

### 1. 文档结构分析提示词优化

#### 优化前特点
- 使用简单的要求列表
- 验证要求相对简单
- 缺乏系统性的质量控制

#### 优化后改进
- **任务目标明确化**：明确定义为"结构化信息提取，生成标准化的文档元数据"
- **约束条件系统化**：将约束条件分为三个核心原则：源材料依赖、零推理、文本忠实
- **字段规范标准化**：详细定义每个提取字段的规范和执行标准
- **质量控制检查点**：建立4个具体的验证检查点

### 2. 初始PPT框架生成提示词优化

#### 优化前特点
- 要求描述较为冗长
- 结构组织不够清晰
- 验证机制相对简单

#### 优化后改进
- **项目信息参数化**：新增项目基本信息（主题、场景、要求）、目标受众信息、风格要求等参数
- **输入参数结构化**：清晰区分项目信息、文档结构元数据、源文档内容、页数约束等输入参数
- **项目信息应用指导**：建立主题适配、场景适配、受众定制、风格要求实现等应用指导
- **约束条件层次化**：分为4个主要约束条件，每个条件下有具体的执行标准
- **内容生成标准优化**：整合项目信息要求，包含主题对齐、受众定制、风格体现等标准
- **生成规范细化**：详细定义标题设计、页数控制、结构组织等规范，结合项目要求
- **输出格式标准化**：提供详细的JSON结构规范和示例
- **质量检查清单化**：建立6项具体的质量检查清单

### 3. 内容细化提示词优化

#### 优化前特点
- 细化原则表述不够精确
- 验证要求相对简单
- 缺乏系统性的执行标准
- 未考虑项目上下文信息

#### 优化后改进
- **项目信息整合**：新增项目基本信息、目标受众信息、风格要求等参数
- **任务目标精确化**：明确定义为"结合项目要求的大纲细化和扩展操作"
- **项目信息应用标准**：建立主题一致性、场景适配性、需求响应性、受众定制化、风格统一性等标准
- **约束条件专业化**：分为4个核心约束条件，每个条件有具体的执行标准
- **执行标准细化**：建立包含项目信息整合的具体执行标准，涵盖内容分析、更新、扩展等各个方面
- **质量控制强化**：建立4个验证检查点和6项质量检查清单

### 4. 最终优化提示词优化

#### 优化前特点
- 优化任务描述较为分散
- 验证要求不够系统
- 缺乏发布质量标准

#### 优化后改进
- **任务目标标准化**：明确定义为"确保输出质量达到发布标准"
- **约束条件系统化**：分为5个核心约束条件，涵盖保真性、完整性、语言规范等
- **执行标准专业化**：建立7个具体的执行标准，涵盖类型分布、内容精炼、逻辑调整等
- **质量控制全面化**：建立4个验证检查点和7项质量检查清单

### 5. 错误恢复提示词优化

#### 优化前特点
- 恢复策略相对简单
- 验证机制不够完善
- 缺乏系统性的恢复标准

#### 优化后改进
- **任务目标明确化**：明确定义为"执行错误恢复操作"
- **约束条件标准化**：分为4个核心约束条件，确保恢复质量
- **生成规范细化**：详细定义基本结构组成和幻灯片规范标准
- **质量控制强化**：建立4个验证检查点，确保恢复结果的可靠性

## 优化效果预期

### 1. 生成内容专业性显著提升
- **书面化程度**：生成的大纲内容将使用正式、规范的书面语言
- **专业化表述**：采用学术或商务场合的专业术语和表达方式
- **表达精炼**：内容表达更加简洁、专业和有力
- **风格统一**：整个大纲保持一致的专业化语言风格

### 2. 结构组织灵活性增强
- **层次清晰**：允许对源材料进行合理的层次化重组
- **逻辑优化**：结构调整更符合PPT演示逻辑
- **展示适配**：重组后的结构更适合PPT展示需求
- **完整保真**：重组过程中确保不遗漏重要信息

### 3. 准确性和可靠性保持
- **源材料依赖**：严格基于源材料，不添加任何外部内容
- **内容保真**：在专业化表达的同时保持原意准确性
- **验证机制**：建立多层次的验证和检查机制
- **质量控制**：确保输出结果的准确性和一致性

### 4. 用户体验改善
- **可读性提升**：专业化的语言表达提升大纲的可读性
- **演示效果**：优化的结构组织提升PPT演示效果
- **专业印象**：书面化的表达给观众留下更专业的印象
- **适用性广泛**：适合各种正式场合的演示需求

## 核心约束保持

在整个优化过程中，以下核心约束得到了完全保持和加强：

1. **严格基于源材料**：所有内容必须100%来源于提供的文档
2. **禁止内容编造**：严禁添加任何源材料外的信息
3. **内容忠实性验证**：每个要点都必须能在源材料中找到对应
4. **完整性检查**：确保覆盖主要内容点，避免遗漏重要信息
5. **多重验证机制**：建立了更加完善的检查和验证体系

## 总结

本次语言优化重点关注**生成内容的书面化和专业化**，在保持所有核心约束和安全机制的前提下，显著提升了PPT大纲生成内容的专业水准和表达质量。

### 主要成果
1. **项目信息全面整合**：所有提示词现在都包含项目主题、应用场景、具体要求、目标受众、风格要求等完整的项目上下文信息
2. **语言表达专业化**：生成的大纲内容将使用正式的书面语言和专业术语，并根据目标受众调整表达方式
3. **结构组织灵活化**：允许对源材料进行合理的层次化重组，提升演示效果，同时适配应用场景
4. **受众定制化增强**：根据目标受众类型和自定义受众描述，调整内容深度、专业程度和表达方式
5. **风格适配性提升**：根据PPT风格要求和自定义风格提示，调整内容组织和表达风格
6. **内容保真性维持**：在专业化表达和项目信息整合的同时严格保持源材料的准确性
7. **用户体验提升**：专业化的表达、优化的结构和项目信息的充分考虑将显著提升PPT的演示效果

优化后的提示词将生成更加专业、正式、适合目标受众和应用场景的PPT大纲，充分体现项目要求和用户偏好，同时保持对源材料的严格依赖和内容保真性。
