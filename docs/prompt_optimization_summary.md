# PPT大纲生成提示词优化总结

## 优化目标
确保生成的PPT大纲严格基于用户提供的源材料内容，禁止任何形式的内容编造或推测。

## 主要优化内容

### 1. 文档结构分析提示词 (`get_structure_analysis_prompt`)
**优化重点：**
- 添加了"仅基于源材料"的严格要求
- 明确禁止推测补充任何未明确提及的内容
- 要求每个提取的要点都必须能在原文中找到明确对应
- 添加了内容提取原则，明确空值处理规则
- 增加了验证要求，要求自检每个信息是否来自原文

**关键改进：**
- 如果文档中没有明确标题，设为null而不是推测
- 如果没有章节结构，设为空数组而不是编造
- 数据必须是实际出现的，不得编造或估算
- 结论必须是明确表达的，不得推理总结

### 2. 初始大纲生成提示词 (`get_initial_outline_prompt`)
**优化重点：**
- 强调大纲内容必须100%基于文档结构和内容
- 禁止添加任何未在源材料中明确出现的信息
- 每个content_points都必须能在源材料中找到对应内容
- 不得进行推理、补充、扩展或编造任何内容

**关键改进：**
- 所有数据、数字、百分比必须是源材料中的原始数据
- 所有结论和观点必须是源材料中明确表述的内容
- 图表配置仅当源材料包含具体数据时才添加
- 如果源材料内容不足，宁可减少页数也不编造内容
- 添加了最终检查清单，确保每个要素都基于源材料

### 3. 内容细化提示词 (`get_refine_outline_prompt`)
**优化重点：**
- 所有细化和扩展内容必须100%基于新增内容和累积上下文
- 禁止基于"创意分析"或"深度洞察"添加不存在的内容
- 保持现有内容的准确性，仅基于新材料进行补充
- 不得为了"视觉效果"而添加不存在的数据

**关键改进：**
- 新增内容必须与现有内容在源材料层面有逻辑关联
- 不得为了"完整性"而添加源材料中不存在的内容
- 如果新增内容不足以支撑更多幻灯片，保持原有结构
- 添加了严格验证要求和检查清单

### 4. 最终优化提示词 (`get_finalize_outline_prompt`)
**优化重点：**
- 所有优化必须严格基于当前大纲中已有的源材料内容
- 禁止进行"创意扩展"、"深度分析"或"前瞻性思考"
- 确保覆盖源材料的所有主要内容点，避免遗漏重要信息
- 验证每个幻灯片内容是否准确反映源材料的原始信息

**关键改进：**
- 图表配置仅为源材料中明确包含的数据添加
- 不得为了"视觉效果"而修改或美化数据
- 幻灯片结构必须反映源材料的实际组织方式
- 添加了内容忠实性、完整性、准确性的多重检查

### 5. 错误恢复提示词 (`get_error_recovery_prompt`)
**优化重点：**
- 所有内容必须100%基于文档内容摘要
- 不得基于"创意能力"或"专业洞察"添加任何内容
- 如果摘要内容不足，宁可简化大纲也不编造内容
- 禁止添加任何"创意内容"或"表现力语言"

**关键改进：**
- 每个content_points都必须能在摘要中找到明确对应
- 所有数据必须是摘要中的原始数据
- 仅为摘要中的实际数据添加图表配置
- 添加了生成前验证要求

## 核心优化原则

### 1. 严格基于源材料
- 所有内容必须能在源材料中找到明确对应
- 禁止任何形式的推理、补充、扩展或编造
- 不得基于常识、经验或"合理性"添加内容

### 2. 禁止内容编造
- 明确禁止"创意扩展"、"深度分析"、"前瞻性思考"
- 不得为了"完整性"或"视觉效果"而编造内容
- 所有数据必须是源材料中的原始数据，不得修改或美化

### 3. 内容忠实性检查
- 每个要点都必须能追溯到源材料中的具体内容
- 添加了多重验证机制和检查清单
- 要求生成前自检每个信息的来源

### 4. 结构化输出
- 保持清晰的层级结构，便于后续PPT制作
- 基于源材料的实际结构进行组织
- 不得为了"逻辑性"而重新组织源材料内容

### 5. 完整性检查
- 确保覆盖源材料的主要内容点，避免遗漏
- 如果源材料内容不足，宁可简化也不编造
- 验证生成的大纲是否准确反映源材料信息

## 预期效果

通过这些优化，PPT大纲生成将：
1. **100%基于源材料**：确保所有内容都有明确的源材料依据
2. **避免内容编造**：彻底杜绝AI模型自行补充或推测内容
3. **保持内容忠实性**：准确反映源材料的原始信息和结构
4. **提供完整覆盖**：确保不遗漏源材料中的重要信息
5. **便于验证追溯**：每个要点都能追溯到源材料中的具体位置

这些改进将显著提高PPT大纲的准确性和可靠性，确保用户获得完全基于其提供材料的高质量大纲。
